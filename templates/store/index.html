{% extends 'store/base.html' %}
{% load static %}

{% block content %}

<div class="d-block d-md-none bg-white border-bottom pb-3">
    <div class="container mt-4">
        <div class="d-flex overflow-auto hide-scrollbar" style="gap: 20px; padding-bottom: 5px;">
            
            <div class="text-center" style="min-width: 70px;">
                <a href="{% url 'store' %}" class="text-decoration-none text-dark">
                    <div class="rounded-circle d-flex align-items-center justify-content-center mx-auto mb-2" style="width: 60px; height: 60px; background: #ffe4e6;">
                        <i class="fas fa-bolt text-danger fs-4"></i>
                    </div>
                    <span style="font-size: 12px; font-weight: 600;">New</span>
                </a>
            </div>

            {% for category in links %}
            <div class="text-center" style="min-width: 70px;">
                <a href="{{ category.get_url }}" class="text-decoration-none text-dark">
                    <div class="rounded-circle mx-auto mb-2 overflow-hidden shadow-sm border" style="width: 60px; height: 60px;">
                        {% if category.image %}
                            <img src="{{ category.image.url }}" alt="{{ category.name }}" style="width: 100%; height: 100%; object-fit: cover;">
                        {% else %}
                            <div class="d-flex align-items-center justify-content-center h-100 bg-light">
                                <i class="fas fa-tshirt text-muted"></i>
                            </div>
                        {% endif %}
                    </div>
                    <span style="font-size: 12px; font-weight: 600;">{{ category.name }}</span>
                </a>
            </div>
            {% endfor %}

        </div>
    </div>
</div>

<div class="container mt-4">
    <h2 class="mb-4 text-center fw-bold">Latest Collection</h2>
    
    <div class="row g-4">
        {% for product in products %}
        <div class="col-md-3 col-6 d-flex align-items-stretch">
            <div class="card h-100 w-100 shadow-sm border-0 position-relative">
                
                <a href="{% url 'product_detail' product.slug %}" class="img-wrap">
                    <img src="{{ product.image.url }}" class="card-img-top" alt="{{ product.name }}" style="height: 250px; object-fit: cover;">
                    
                    {% if product.old_price > product.price %}
                        <span class="badge bg-danger position-absolute top-0 start-0 m-2">SALE</span>
                    {% endif %}
                </a>

                <div class="card-body d-flex flex-column text-center p-3">
                    <h5 class="card-title" style="font-size: 1rem; min-height: 40px; display: flex; align-items: center; justify-content: center;">
                        <a href="{% url 'product_detail' product.slug %}" class="text-decoration-none text-dark">{{ product.name }}</a>
                    </h5>
                    
                    <div class="mt-auto">
                        
                        {% if product.old_price > product.price %}
                            <div class="price-wrap mb-1">
                                <span class="text-muted text-decoration-line-through me-1 small">₹{{ product.old_price }}</span>
                                <span class="fw-bold text-success fs-5">₹{{ product.price }}</span>
                            </div>
                        {% else %}
                            <div class="price-wrap mb-1">
                                <span class="fw-bold text-dark fs-5">₹{{ product.price }}</span>
                            </div>
                        {% endif %}

                        <div class="rating-star mb-3 d-flex justify-content-center align-items-center" style="min-height: 20px; font-size: 12px;">
                            <span class="text-warning me-1">
                                <i class="fa fa-star{% if product.averageReview < 0.5 %}-o{% elif product.averageReview >= 0.5 and product.averageReview < 1 %}-half-o {% endif %}" aria-hidden="true"></i>
                                <i class="fa fa-star{% if product.averageReview < 1.5 %}-o{% elif product.averageReview >= 1.5 and product.averageReview < 2 %}-half-o {% endif %}" aria-hidden="true"></i>
                                <i class="fa fa-star{% if product.averageReview < 2.5 %}-o{% elif product.averageReview >= 2.5 and product.averageReview < 3 %}-half-o {% endif %}" aria-hidden="true"></i>
                                <i class="fa fa-star{% if product.averageReview < 3.5 %}-o{% elif product.averageReview >= 3.5 and product.averageReview < 4 %}-half-o {% endif %}" aria-hidden="true"></i>
                                <i class="fa fa-star{% if product.averageReview < 4.5 %}-o{% elif product.averageReview >= 4.5 and product.averageReview < 5 %}-half-o {% endif %}" aria-hidden="true"></i>
                            </span>
                            <span class="text-muted">({{ product.countReview }})</span>
                        </div>

                        <a href="{% url 'product_detail' product.slug %}" class="btn btn-outline-dark btn-sm w-100 rounded-pill">View Details</a>
                    </div>
                </div>

            </div>
        </div>
        {% endfor %}
    </div>
</div>

<style>
    /* Scrollbar chupane ka magic code */
    .hide-scrollbar::-webkit-scrollbar {
        display: none; /* Chrome, Safari, Opera */
    }
    .hide-scrollbar {
        -ms-overflow-style: none;  /* IE and Edge */
        scrollbar-width: none;  /* Firefox */
    }
    
    /* Hover effect for cards */
    .card:hover {
        transform: translateY(-5px);
        transition: transform 0.3s ease;
        box-shadow: 0 10px 20px rgba(0,0,0,0.1) !important;
    }
</style>
{% endblock %}